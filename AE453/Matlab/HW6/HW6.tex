\documentclass[11pt]{article}
\usepackage[utf8]{inputenc} % Para caracteres en español
\usepackage{amsmath,amsthm,amsfonts,amssymb,amscd}
\usepackage{multirow,booktabs}
\usepackage[table]{xcolor}
\usepackage{fullpage}
\usepackage{lastpage}
\usepackage{enumitem}

\usepackage{tikz}
\newcommand{\stencilpt}[4][]{\node[circle,draw,inner sep=0.3em,minimum size=2cm,#1] at (#2) (#3) {#4}}
\newcommand{\stencilpta}[4][]{\node[square,draw,inner sep=0.3em,minimum size=2cm,#1] at (#2) (#3) {#4}}



\usepackage{multicol}
\usepackage{fancyhdr}
\usepackage{mathrsfs}
\usepackage{pdfpages}
\usepackage{wrapfig}
\usepackage{setspace}
\usepackage{esvect}
\usepackage{calc}
\usepackage{multicol}
\usepackage{cancel}
\usepackage{graphicx}
\graphicspath{ {pictures/} }
\usepackage[retainorgcmds]{IEEEtrantools}
\usepackage[margin=3cm]{geometry}
\usepackage{amsmath}
\newlength{\tabcont}
\setlength{\parindent}{0.0in}
\setlength{\parskip}{0.05in}
\usepackage{empheq}
\usepackage{framed}
\usepackage[most]{tcolorbox}
\usepackage{xcolor}
\colorlet{shadecolor}{orange!15}
\parindent 0in
\parskip 12pt
\geometry{margin=1in, headsep=0.25in}
\theoremstyle{definition}
\newtheorem{defn}{Definition}
\newtheorem{reg}{Rule}
\newtheorem{exer}{Exercise}
% Two more packages that make it easy to show MATLAB code
\usepackage[T1]{fontenc}
\usepackage[framed,numbered]{matlab-prettifier}
\lstset{
	style = Matlab-editor,
	basicstyle=\mlttfamily\small,
}
\newtheorem{note}{Note}
\begin{document}  
\setcounter{section}{0}
\thispagestyle{empty}

\begin{center}
{\LARGE \bf Homework 5}\\
{\large AE435 - Spring 2018 \\ Emilio R. Gordon}
\end{center}
\vspace{0mm}
\textbf{Problem 2} \\ \\

\begin{lstlisting}
function HW6
    %Given Parameters
    MW = 29.948;             % Argon Molecular Weight [amu]
    ei = 15.76;              % Ionization Energy [eV] 
    G = 2e11;                % Scaling Constant [K^{-3/4}*m^{-3/2}]
    T_low = 5000;            % Lower Temperature Bound [K]   
    T_high = 10000;          % Higher Temperature Bound [K]
    k = 8.6173303e-5;        % Boltzmann's constant [eV/K]
    k2 = 1.38064852e-23;     % Boltzmann's Constant [J/K] or [m^2 kg s^-2 K^-1]
    %Conversions 
    MW = MW*(1.66054e-27); % [amu] to [kg]
    
    %STP Conditions
    T_STP = 273.15; % STP Temperature [K]
    P_STP = 101325;   % STP Pressure [Pa] = [kg/ms^2]
    
    no = P_STP/(k2*T_STP); %Total Density of Heavy Particles
    %10% from STP
    no = no*.1
    
    T = T_low:1:T_high;
    alpha = zeros(length(T),1);
    eta = zeros(length(T),1);
    
    for i=1:length(T)
        %Small SAHA Equation
        alpha(i) = G*(no^(-1/2))*(T(i)^(3/4))*exp(-ei/(2*k*T(i)));
        
        %Collision Cross-Sections
        Q_en = 10e-20;                   % Electron-Neutral: Collision Cross Section [m^2]
        Q_ei = 6.5e-17/((3/2)*k*T(i))^2; % Electron-Ion: Collision Cross Section [m^2]
            
        %Collision Frequencies
        np = no*alpha(i);
        na = no*(1-alpha(i));
        
        nu_en = na*Q_en;
        nu_ei = np*Q_ei;
        
        eta(i) = nu_ei/nu_en;
    end
    % Plotting Code Removed
end

\end{lstlisting}

\newpage
\textbf{Problem 3}
\begin{lstlisting}
function HW6P3
    %Given Parameters
    MW = 208.98;             % Bismuth Molecular Weight [amu]
    ei = 7.29;               % Ionization Energy [eV] 
    u = 1.2566370614e-6;     % N/A^2
    mdot_3 = 3;              % Mass Flow Rate [g/s]
    mdot_6 = 6;              % Mass Flow Rate [g/s]
    J_low = 3;               % Lower Current [kA]
    J_high = 25;             % Higher Current [kA]

    %Dimensions for the Princeton Benchmark Thruster [cm]
    PBT = [0.95, 5.1, 9.3, 6.4, 0.95, 10]; 
    %     [r_c, r_a, r_ao, r_ch, t_a, l_c]

    %Conversions 
    MW = MW*(1.66054e-27); % [amu] to [kg]
    ei = ei*(1.60218e-19); % [eV] to [Joules]
    mdot_3 = mdot_3*1e-3;  % [g/s] to [kg/s]
    mdot_6 = mdot_6*1e-3;  % [g/s] to [kg/s]
    J_low = J_low*1000;    % [kA] to [A]
    J_high = J_high*1000;  % [kA] to [A]

    J = J_low:1:J_high;

    Ct_3 = zeros(length(J),1);
    Ct_6 = zeros(length(J),1);
    T_3 = zeros(length(J),1);
    T_6 = zeros(length(J),1);
    ue_3 = zeros(length(J),1);
    ue_6 = zeros(length(J),1);
    Isp_3 = zeros(length(J),1);
    Isp_6 = zeros(length(J),1);
    jet_3 = zeros(length(J),1);
    jet_6 = zeros(length(J),1);

    ra = PBT(2);
    rc = PBT(1);

    for i=1:length(J)
        xi_3 = xi(J(i),u,ra,rc,mdot_3,ei, MW);
        xi_6 = xi(J(i),u,ra,rc,mdot_6,ei, MW);

        Ct_3(i) = C_T(mdot_3,xi_3,ra,rc);
        Ct_6(i) = C_T(mdot_6,xi_6,ra,rc);

        T_3(i) = T(Ct_3(i),u,J(i));
        T_6(i) = T(Ct_6(i),u,J(i));

        ue_3(i) = T_3(i)/mdot_3;
        ue_6(i) = T_6(i)/mdot_6;

        Isp_3(i) = ue_3(i)/9.81;
        Isp_6(i) = ue_6(i)/9.81;

        jet_3(i) = (.5*T_3(i)*ue_3(i))/1000;
        jet_6(i) = (.5*T_6(i)*ue_6(i))/1000;
    end

    JJ = linspace(3,25,length(J)); %convenient plotting for current

    % Superficial Plotting Code Removed
    subplot(2,2,1)
    plot(JJ,Ct_3,JJ,Ct_6,'linewidth',2)

    subplot(2,2,2)
    plot(JJ,T_3,JJ,T_6,'linewidth',2)

    subplot(2,2,3)
    plot(JJ,Isp_3,JJ,Isp_6,'linewidth',2)

    subplot(2,2,4)
    plot(JJ,jet_3,JJ,jet_6,'linewidth',2)

end

function nu = nu(mdot)
    mdot_star = 0.066;
    nu = mdot/mdot_star;
end

function xi = xi(J,u,ra,rc,mdot,ei, MW)
    xi = (J*sqrt((u/(4*pi))*log(ra/rc)))/(sqrt(mdot)*(((2*ei)/MW)^(1/4)));
end

function C_T = C_T(mdot,xi,ra,rc)
    C_T = (nu(mdot)/(xi^4)) + log((ra/rc) + (xi^2));
end

function T = T(C_T,u,J)
    T = C_T*(u/(4*pi))*(J^2);
end
\end{lstlisting}
\end{document}